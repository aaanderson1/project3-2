(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e,n,t){},105:function(e,n,t){},106:function(e,n,t){"use strict";t.r(n);var a=t(0),o=t.n(a),i=t(29),r=t(23),s=t(19),c=t(10),l=t(11),u=t(17),h=t(15),g=t(16),m=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"shower_though_secret";Object(c.a)(this,e),this.tokenName=n,this.token=null,this.loadToken()}return Object(l.a)(e,[{key:"loadToken",value:function(){var e=window.localStorage.getItem(this.tokenName);if(e){var n=JSON.parse(e);if(n.token&&n.dateTimeString){var t=new Date(n.dateTimeString);new Date<t&&n.token&&(this.token=n.token)}}}},{key:"saveToken",value:function(e){this.token=e;var n=new Date;n.setMinutes(n.getMinutes()+60),window.localStorage.setItem(this.tokenName,JSON.stringify({token:this.token,dateTimeString:n.toISOString()}))}}]),e}(),p=(t(46),function(e){function n(){return Object(c.a)(this,n),Object(u.a)(this,Object(h.a)(n).apply(this,arguments))}return Object(g.a)(n,e),Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this,n=new m;null!==n.token?fetch("".concat(window.location.origin.toString(),"/api/anon/").concat(n.token)).then(function(e){return e.json()}).then(function(t){t.length>0&&t[0]._id===n.token?(console.log(t),e.props.history.push("messages")):e.props.history.push("login")}):this.props.history.push("login")}},{key:"render",value:function(){return o.a.createElement("div",null)}}]),n}(o.a.Component)),d=t(22),f=t(107),v=t(111),E=["grinning","neutral","rolling","slightly","sunglasses","thinking"],k=function(e){function n(e){var t;return Object(c.a)(this,n),(t=Object(u.a)(this,Object(h.a)(n).call(this,e))).state={avatar:E[Math.floor(Math.random()*E.length)]},t.login=t.login.bind(Object(d.a)(t)),t}return Object(g.a)(n,e),Object(l.a)(n,[{key:"componentDidMount",value:function(){null===(new m).token||this.props.onComplete()}},{key:"login",value:function(){var e=this;return fetch("".concat(window.location.origin.toString(),"/api/anon"),{method:"POST",body:JSON.stringify(this.state),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(n){console.log(n),(new m).saveToken(n._id),e.props.onComplete()}).catch(function(n){e.props.onComplete(n)})}},{key:"render",value:function(){var e=this,n=t(25)("./".concat(this.state.avatar,".png"));return o.a.createElement("div",null,o.a.createElement(f.a,{src:n,roundedCircle:!0}),o.a.createElement(v.a,{variant:"outline-primary",onClick:function(){return e.login()}},"Login"))}}]),n}(o.a.Component),b=function(e){function n(){return Object(c.a)(this,n),Object(u.a)(this,Object(h.a)(n).apply(this,arguments))}return Object(g.a)(n,e),Object(l.a)(n,[{key:"componentDidMount",value:function(){null===(new m).token||this.props.history.push("/")}},{key:"onComplete",value:function(e){e&&(console.log(e),(new m).saveToken(null));this.props.history.push("/")}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(k,{onComplete:this.onComplete.bind(this)}))}}]),n}(o.a.Component),w=t(110),y=function(e){function n(){return Object(c.a)(this,n),Object(u.a)(this,Object(h.a)(n).apply(this,arguments))}return Object(g.a)(n,e),Object(l.a)(n,[{key:"render",value:function(){var e=this,n=t(25)("./".concat(this.props.message.mood,".png"));return o.a.createElement("div",null,o.a.createElement(w.a,null,o.a.createElement(w.a.Body,null,o.a.createElement(f.a,{src:n,roundedCircle:!0}),this.props.message.message,this.props.owned&&o.a.createElement(v.a,{variant:"outline-primary",onClick:function(){return e.props.deleteCallback(e.props.message._id)}},"X"))))}}]),n}(o.a.Component),O=t(108),j=t(109),C=t(112),S=(t(26),t(14)),T=(t(99),function(e){function n(e){var t;return Object(c.a)(this,n),(t=Object(u.a)(this,Object(h.a)(n).call(this,e))).state={messages:[],anon:{_id:"???????",avatar:"haha"},loading:!0},t}return Object(g.a)(n,e),Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this,n=new m;null!==n.token?this.login(n.token).then(function(){return e.getMessages()}):this.props.history.push("/")}},{key:"login",value:function(e){var n=this;return fetch("".concat(window.location.origin.toString(),"/api/anon/").concat(e)).then(function(e){return e.json()}).then(function(t){t.length>0&&t[0]._id===e?(console.log(t),n.setState({anon:t[0]}),setInterval(function(){this.getMessages()}.bind(n),3e3)):((new m).saveToken(null),n.props.history.push("/"))}).catch(function(e){(new m).saveToken(null),n.props.history.push("/")})}},{key:"getMessages",value:function(){var e=this;return fetch("".concat(window.location.origin.toString(),"/api/messages")).then(function(e){return e.json()}).then(function(n){n=n.reverse(),console.log(n),e.setState({anon:e.state.anon,messages:n,loading:!1})})}},{key:"handleKeyPress",value:function(e){var n=this;if(13===e.charCode){var t=e.target.value;return e.target.value="",console.log(t),fetch("".concat(window.location.origin.toString(),"/api/message"),{method:"POST",body:JSON.stringify({message:t,anon:this.state.anon._id,mood:this.state.anon.avatar}),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){n.getMessages()}).catch(function(e){console.log(e)})}}},{key:"deleteMessage",value:function(e){var n=this;return fetch("".concat(window.location.origin.toString(),"/api/message/").concat(e,"/").concat(this.state.anon._id),{method:"DELETE"}).then(function(e){return e.json()}).then(function(e){n.getMessages()}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this;if(this.state.loading)return o.a.createElement("div",null,o.a.createElement(O.a,{animation:"grow",variant:"primary"}),o.a.createElement(O.a,{animation:"grow",variant:"secondary"}),o.a.createElement(O.a,{animation:"grow",variant:"success"}),o.a.createElement(O.a,{animation:"grow",variant:"danger"}),o.a.createElement(O.a,{animation:"grow",variant:"warning"}),o.a.createElement(O.a,{animation:"grow",variant:"info"}),o.a.createElement(O.a,{animation:"grow",variant:"light"}),o.a.createElement(O.a,{animation:"grow",variant:"dark"}));var n=t(25)("./".concat(this.state.anon.avatar,".png"));return o.a.createElement(S.Row,{className:"messagesTopRow"},o.a.createElement(S.Col,{m:6,s:6,l:6},o.a.createElement(S.Card,{header:o.a.createElement(S.CardTitle,null),actions:[o.a.createElement("a",null)]},o.a.createElement(f.a,{src:n,roundedCircle:!0}),o.a.createElement(j.a,{onKeyPress:this.handleKeyPress.bind(this),className:"mb-3"},o.a.createElement(j.a.Prepend,null,o.a.createElement(j.a.Text,{id:"inputGroup-sizing-default"},"What's on your mind?")),o.a.createElement(C.a,{"aria-label":"Default","aria-describedby":"inputGroup-sizing-default"})))),this.state.messages.map(function(n){return o.a.createElement(y,{message:n,deleteCallback:e.deleteMessage.bind(e),owned:e.state.anon._id===n.anon})}))}}]),n}(o.a.Component)),N=function(){return o.a.createElement("main",null,o.a.createElement(r.a,null,o.a.createElement(s.c,null,o.a.createElement(s.a,{exact:!0,path:"/",component:p}),o.a.createElement(s.a,{path:"/login",component:b}),o.a.createElement(s.a,{path:"/messages",component:T}))))};t(104);var M=function(){return o.a.createElement(S.Navbar,{brand:o.a.createElement("a",null),alignLinks:"right",className:"navbarcolor"},o.a.createElement("img",{src:"https://i.pinimg.com/originals/20/c7/bc/20c7bcfe40f464961ed209e3deadf8b6.png",className:"navbarlogo",height:"100px",width:"100px"}),o.a.createElement(S.NavItem,{href:"components.html",class:"white-text"},"Log Out"))};t(105);var x=function(){return o.a.createElement(S.Section,null,o.a.createElement(S.Section,{className:"parallax"},o.a.createElement("h1",{className:"title"},"Shower Thoughts")))},_=function(){return o.a.createElement("div",null,o.a.createElement(M,null),o.a.createElement(x,null),o.a.createElement(N,null))};Object(i.render)(o.a.createElement(r.a,null,o.a.createElement(_,null)),document.getElementById("root"))},25:function(e,n,t){var a={"./grinning.png":47,"./neutral.png":48,"./rolling.png":49,"./slightly.png":50,"./sunglasses.png":51,"./thinking.png":52};function o(e){var n=i(e);return t(n)}function i(e){if(!t.o(a,e)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=i,e.exports=o,o.id=25},41:function(e,n,t){e.exports=t(106)},46:function(e,n,t){},47:function(e,n,t){e.exports=t.p+"static/media/grinning.a5c4c868.png"},48:function(e,n,t){e.exports=t.p+"static/media/neutral.a7fe3123.png"},49:function(e,n,t){e.exports=t.p+"static/media/rolling.8d0d9682.png"},50:function(e,n,t){e.exports=t.p+"static/media/slightly.f8af4936.png"},51:function(e,n,t){e.exports=t.p+"static/media/sunglasses.4238fe56.png"},52:function(e,n,t){e.exports=t.p+"static/media/thinking.872be34d.png"},99:function(e,n,t){}},[[41,1,2]]]);
//# sourceMappingURL=main.b0ab8727.chunk.js.map