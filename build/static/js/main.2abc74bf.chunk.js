(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e,n,t){"use strict";t.r(n);var a=t(0),o=t.n(a),i=t(27),r=t(22),c=t(18),s=t(10),l=t(11),u=t(16),h=t(14),g=t(15),p=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"shower_though_secret";Object(s.a)(this,e),this.tokenName=n,this.token=null,this.loadToken()}return Object(l.a)(e,[{key:"loadToken",value:function(){var e=window.localStorage.getItem(this.tokenName);if(e){var n=JSON.parse(e);if(n.token&&n.dateTimeString){var t=new Date(n.dateTimeString);new Date<t&&n.token&&(this.token=n.token)}}}},{key:"saveToken",value:function(e){this.token=e;var n=new Date;n.setMinutes(n.getMinutes()+60),window.localStorage.setItem(this.tokenName,JSON.stringify({token:this.token,dateTimeString:n.toISOString()}))}}]),e}(),m=(t(45),function(e){function n(){return Object(s.a)(this,n),Object(u.a)(this,Object(h.a)(n).apply(this,arguments))}return Object(g.a)(n,e),Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this,n=new p;null!==n.token?fetch("".concat(window.location.origin.toString(),"/api/anon/").concat(n.token)).then(function(e){return e.json()}).then(function(t){t.length>0&&t[0]._id===n.token?(console.log(t),e.props.history.push("messages")):e.props.history.push("login")}):this.props.history.push("login")}},{key:"render",value:function(){return o.a.createElement("div",null)}}]),n}(o.a.Component)),d=t(21),f=t(105),v=t(109),k=["grinning","neutral","rolling","slightly","sunglasses","thinking"],y=function(e){function n(e){var t;return Object(s.a)(this,n),(t=Object(u.a)(this,Object(h.a)(n).call(this,e))).state={avatar:k[Math.floor(Math.random()*k.length)]},t.login=t.login.bind(Object(d.a)(t)),t}return Object(g.a)(n,e),Object(l.a)(n,[{key:"componentDidMount",value:function(){null===(new p).token||this.props.onComplete()}},{key:"login",value:function(){var e=this;return fetch("".concat(window.location.origin.toString(),"/api/anon"),{method:"POST",body:JSON.stringify(this.state),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(n){console.log(n),(new p).saveToken(n._id),e.props.onComplete()}).catch(function(n){e.props.onComplete(n)})}},{key:"render",value:function(){var e=this,n=t(24)("./".concat(this.state.avatar,".png"));return o.a.createElement("div",null,o.a.createElement(f.a,{src:n,roundedCircle:!0}),o.a.createElement(v.a,{variant:"outline-primary",onClick:function(){return e.login()}},"Login"))}}]),n}(o.a.Component),b=function(e){function n(){return Object(s.a)(this,n),Object(u.a)(this,Object(h.a)(n).apply(this,arguments))}return Object(g.a)(n,e),Object(l.a)(n,[{key:"componentDidMount",value:function(){null===(new p).token||this.props.history.push("/")}},{key:"onComplete",value:function(e){e&&(console.log(e),(new p).saveToken(null));this.props.history.push("/")}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(y,{onComplete:this.onComplete.bind(this)}))}}]),n}(o.a.Component),E=t(108),w=function(e){function n(){return Object(s.a)(this,n),Object(u.a)(this,Object(h.a)(n).apply(this,arguments))}return Object(g.a)(n,e),Object(l.a)(n,[{key:"render",value:function(){var e=this,n=t(24)("./".concat(this.props.message.mood,".png"));return o.a.createElement("div",null,o.a.createElement(E.a,null,o.a.createElement(E.a.Body,null,o.a.createElement(f.a,{src:n,roundedCircle:!0}),this.props.message.message,this.props.owned&&o.a.createElement(v.a,{variant:"outline-primary",onClick:function(){return e.props.deleteCallback(e.props.message._id)}},"X"))))}}]),n}(o.a.Component),O=t(106),j=t(107),C=t(110),S=function(e){function n(e){var t;return Object(s.a)(this,n),(t=Object(u.a)(this,Object(h.a)(n).call(this,e))).state={messages:[],anon:{_id:"???????",avatar:"haha"},loading:!0},t}return Object(g.a)(n,e),Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this,n=new p;null!==n.token?this.login(n.token).then(function(){return e.getMessages()}):this.props.history.push("/")}},{key:"login",value:function(e){var n=this;return fetch("".concat(window.location.origin.toString(),"/api/anon/").concat(e)).then(function(e){return e.json()}).then(function(t){t.length>0&&t[0]._id===e?(console.log(t),n.setState({anon:t[0]})):((new p).saveToken(null),n.props.history.push("/"))}).catch(function(e){(new p).saveToken(null),n.props.history.push("/")})}},{key:"getMessages",value:function(){var e=this;return fetch("".concat(window.location.origin.toString(),"/api/messages")).then(function(e){return e.json()}).then(function(n){n=n.reverse(),console.log(n),e.setState({anon:e.state.anon,messages:n,loading:!1})})}},{key:"handleKeyPress",value:function(e){var n=this;if(13===e.charCode){var t=e.target.value;return e.target.value="",console.log(t),fetch("".concat(window.location.origin.toString(),"/api/message"),{method:"POST",body:JSON.stringify({message:t,anon:this.state.anon._id,mood:this.state.anon.avatar}),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){n.getMessages()}).catch(function(e){console.log(e)})}}},{key:"deleteMessage",value:function(e){var n=this;return fetch("".concat(window.location.origin.toString(),"/api/message/").concat(e,"/").concat(this.state.anon._id),{method:"DELETE"}).then(function(e){return e.json()}).then(function(e){n.getMessages()}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this;if(this.state.loading)return o.a.createElement("div",null,o.a.createElement(O.a,{animation:"grow",variant:"primary"}),o.a.createElement(O.a,{animation:"grow",variant:"secondary"}),o.a.createElement(O.a,{animation:"grow",variant:"success"}),o.a.createElement(O.a,{animation:"grow",variant:"danger"}),o.a.createElement(O.a,{animation:"grow",variant:"warning"}),o.a.createElement(O.a,{animation:"grow",variant:"info"}),o.a.createElement(O.a,{animation:"grow",variant:"light"}),o.a.createElement(O.a,{animation:"grow",variant:"dark"}));var n=t(24)("./".concat(this.state.anon.avatar,".png"));return o.a.createElement("div",null,o.a.createElement(E.a,null,o.a.createElement(E.a.Body,null,o.a.createElement(f.a,{src:n,roundedCircle:!0}),o.a.createElement(E.a,null,o.a.createElement(E.a.Body,null,o.a.createElement(j.a,{onKeyPress:this.handleKeyPress.bind(this),className:"mb-3"},o.a.createElement(j.a.Prepend,null,o.a.createElement(j.a.Text,{id:"inputGroup-sizing-default"},"What's on your mind?")),o.a.createElement(C.a,{"aria-label":"Default","aria-describedby":"inputGroup-sizing-default"})))))),this.state.messages.map(function(n){return o.a.createElement(w,{message:n,deleteCallback:e.deleteMessage.bind(e),owned:e.state.anon._id===n.anon})}))}}]),n}(o.a.Component),T=function(){return o.a.createElement("main",null,o.a.createElement(r.a,null,o.a.createElement(c.c,null,o.a.createElement(c.a,{exact:!0,path:"/",component:m}),o.a.createElement(c.a,{path:"/login",component:b}),o.a.createElement(c.a,{path:"/messages",component:S}))))},M=(t(58),t(59),t(30));var N=function(){return o.a.createElement(M.Navbar,{brand:o.a.createElement("a",null),alignLinks:"right",className:"navbarcolor"},o.a.createElement("img",{src:"https://i.pinimg.com/originals/20/c7/bc/20c7bcfe40f464961ed209e3deadf8b6.png",className:"navbarlogo",height:"100px",width:"100px"}),o.a.createElement(M.NavItem,{href:"components.html",class:"white-text"},"Log Out"))},x=function(){return o.a.createElement("div",null,o.a.createElement(N,null),o.a.createElement(T,null))};Object(i.render)(o.a.createElement(r.a,null,o.a.createElement(x,null)),document.getElementById("root"))},24:function(e,n,t){var a={"./grinning.png":46,"./neutral.png":47,"./rolling.png":48,"./slightly.png":49,"./sunglasses.png":50,"./thinking.png":51};function o(e){var n=i(e);return t(n)}function i(e){if(!t.o(a,e)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=i,e.exports=o,o.id=24},40:function(e,n,t){e.exports=t(104)},45:function(e,n,t){},46:function(e,n,t){e.exports=t.p+"static/media/grinning.a5c4c868.png"},47:function(e,n,t){e.exports=t.p+"static/media/neutral.a7fe3123.png"},48:function(e,n,t){e.exports=t.p+"static/media/rolling.8d0d9682.png"},49:function(e,n,t){e.exports=t.p+"static/media/slightly.f8af4936.png"},50:function(e,n,t){e.exports=t.p+"static/media/sunglasses.4238fe56.png"},51:function(e,n,t){e.exports=t.p+"static/media/thinking.872be34d.png"},58:function(e,n,t){}},[[40,1,2]]]);
//# sourceMappingURL=main.2abc74bf.chunk.js.map